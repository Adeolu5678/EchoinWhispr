# Key User Flows

Flow 1: New User Onboarding & Persona Creation
Goal: To get a new user from landing on the site to having a searchable profile.
Steps:
User opens web app.
System displays [Screen: Sign In / Sign Up].
User signs in via Clerk (Google, Email, etc.).
System authenticates and retrieves user identity.
System calls Convex `users.getPersona` to check if initialized.
Convex returns `null` or `not_initialized`.
System displays [Screen: Create Persona].
User fills in "Career," "Interests," and "Current Mood."
System (Next.js) validates inputs.
User clicks "Create Persona".
System calls Convex `users.createPersona` mutation.
System shows a "Creating your anonymous persona..." loading state.
Mutation confirms and updates reactive state.
System displays [Screen: Main Dashboard] (showing the "Search" tab).
Flow Complete.
Flow 2: Search, Discover, & Initiate "Whisper" (w/ Paywall)
Goal: To let a user (like Devin) find a persona and send a new "Whisper," encountering the "lax" paywall.
Steps:
User is on [Screen: Main Dashboard].
User clicks the "Search" navigation icon.
System navigates to [Screen: Search & Filter].
System displays "Syncing user directory..." progress bar.
Sync completes. The search/filter inputs become active.
User types "UI/UX Designer" into "Career".
System (client-side) filters the downloaded list.
System displays matching persona cards.
User clicks on a persona.
System displays [Screen: View Persona & Send Whisper].
User types a message and clicks "Send Whisper."
System checks checkSubscription(devin_address).
Result: false (User is on free tier).
System (client-side) checks local storage: getDailyWhisperCount().
System branches logic:
Case A (Limit Not Reached): dailyWhisperCount < 5
System proceeds: Encrypts msg, uploads to IPFS, prompts wallet for HCS submit.
System increments local count: setDailyWhisperCount(count + 1).
System shows "Whisper Sent!" confirmation.
Flow Complete.
Case B (Limit Reached): dailyWhisperCount >= 5
System displays [Screen: Daily Limit Reached].
User can "Subscribe" or "Wait".
If User subscribes (e.g., subscribeWithHBAR()), they are returned to the message, which sends automatically.
Flow Complete.
Flow 3: Receive, Read, & Reply
Goal: To let a user safely receive, read, and reply to a new "Whisper."
Steps:
User logs in via Clerk.
User clicks the "Inbox" navigation icon.
System displays [Screen: Inbox].
Convex triggers a reactive update for new messages.
Sync completes. A new message matching the user's persona has been received.
System displays the Inbox tabs: "Chats" and "Requests (1)".
User clicks "Requests (1)".
User sees the new "Whisper" from "Anonymous Persona".
User clicks the Whisper.
System displays [Screen: Whisper Request].
User reads the message. They have two options:
Option A: Click the "Back" icon (ignore). The message remains in "Requests."
Option B: Click the "Accept" button.
System (on "Accept") updates the whisper status to 'accepted' in Convex.
System navigates to [Screen: Conversation View].
User types a reply: "Thanks!"
User clicks "Send."
System executes the reply mutation in Convex (encrypt, store).
No subscription check is needed (replies are free).
Flow Complete.
